---
import { site } from '../data/site';
import Signature from '../assets/Signature.svg?raw';

type NavItem = { label: string; href: string };
const nav: NavItem[] = [
	{ label: 'Projects', href: '/projects' },
	{ label: 'Experience', href: '/experience' },
	{ label: 'About', href: '/about' },
];

const pathname = Astro.url.pathname;
const isActive = (href: string) => (href === '/' ? pathname === '/' : pathname.startsWith(href));
---

<header class="sticky top-0 z-20 border-b border-[rgb(var(--border))] bg-[rgb(var(--bg))]/85 backdrop-blur">
	<div class="mx-auto flex max-w-5xl items-center justify-between gap-4 px-4 pt-4">
		<div class="min-w-0">
			<a class="btn-pressdown focus-ring inline-flex items-center gap-3 no-underline" href="/">
				<span 
					class="inline-block h-auto w-28 text-[rgb(var(--fg))]" 
					set:html={Signature.replace(/fill="#000000"/g, 'fill="currentColor"')} 
				/>
			</a>
		</div>

		<nav class="hidden items-center gap-1 sm:flex" aria-label="Primary">
			{nav.map((item) => (
				<a
					class:list={[
						'btn-pressdown focus-ring px-3 py-2 text-sm no-underline',
						isActive(item.href)
							? 'bg-[rgb(var(--bg))] text-[rgb(var(--fg))] ring-1 ring-[rgb(var(--border))]'
							: 'text-[rgb(var(--muted))] hover:text-[rgb(var(--fg))]',
					]}
					href={item.href}
				>
					{item.label}
				</a>
			))}
		</nav>

		<div class="flex items-center gap-2">
			<details class="relative sm:hidden">
				<summary
					class="btn-pressdown focus-ring [&::-webkit-details-marker]:hidden [&::marker]:hidden list-none cursor-pointer grid size-10 place-items-center border border-[rgb(var(--border))] bg-[rgb(var(--bg))] text-[rgb(var(--fg))]"
					aria-label="Open menu"
					title="Menu"
				>
					<span class="sr-only">Menu</span>
					<svg
						class="size-5"
						viewBox="0 0 24 24"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
						aria-hidden="true"
					>
						<path
							d="M4 7h16M4 12h16M4 17h16"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
						/>
					</svg>
				</summary>

				<div
					class="absolute right-0 top-full mt-2 w-56 overflow-hidden border border-[rgb(var(--border))] bg-[rgb(var(--bg))] shadow-lg"
				>
					<nav class="flex flex-col p-2" aria-label="Primary (mobile)">
						{nav.map((item) => (
							<a
								class:list={[
									'btn-pressdown focus-ring px-3 py-2 text-sm no-underline',
									isActive(item.href)
										? 'bg-[rgb(var(--card))] text-[rgb(var(--fg))] ring-1 ring-[rgb(var(--border))]'
										: 'text-[rgb(var(--muted))] hover:bg-[rgb(var(--card))] hover:text-[rgb(var(--fg))]',
								]}
								href={item.href}
							>
								{item.label}
							</a>
						))}
						<div class="my-2 border-t border-[rgb(var(--border))]"></div>
						<a
							class="btn-pressdown focus-ring px-3 py-2 text-sm text-[rgb(var(--muted))] no-underline hover:bg-[rgb(var(--card))] hover:text-[rgb(var(--fg))]"
							href={`mailto:${site.email}`}
							data-copy-email
							data-email={site.email}
							aria-label="Copy email"
							title="Copy email"
						>
							<span class="inline-flex items-center gap-2">
								<i class="fa-regular fa-copy text-xs leading-none" aria-hidden="true"></i>
								Email
							</span>
						</a>
						<a
							class="btn-pressdown focus-ring px-3 py-2 text-sm text-[rgb(var(--muted))] no-underline hover:bg-[rgb(var(--card))] hover:text-[rgb(var(--fg))]"
							href={site.github}
							target="_blank"
							rel="noreferrer"
						>
							GitHub
						</a>
						<a
							class="btn-pressdown focus-ring px-3 py-2 text-sm text-[rgb(var(--muted))] no-underline hover:bg-[rgb(var(--card))] hover:text-[rgb(var(--fg))]"
							href={site.linkedin}
							target="_blank"
							rel="noreferrer"
						>
							LinkedIn
						</a>
					</nav>
				</div>
			</details>

			<a
				class="btn-pressdown focus-ring hidden size-10 items-center justify-center border border-transparent text-[rgb(var(--muted))] no-underline hover:border-[rgb(var(--border))] hover:text-[rgb(var(--fg))] sm:inline-flex"
				href={`mailto:${site.email}`}
				data-copy-email
				data-email={site.email}
				aria-label="Copy email"
				title="Copy email"
			>
				<i class="fa-solid fa-envelope leading-none" aria-hidden="true"></i>
			</a>
			<a
				class="btn-pressdown focus-ring hidden size-10 items-center justify-center border border-transparent text-[rgb(var(--muted))] no-underline hover:border-[rgb(var(--border))] hover:text-[rgb(var(--fg))] sm:inline-flex"
				href={site.github}
				target="_blank"
				rel="noreferrer"
				aria-label="GitHub"
				title="GitHub"
			>
				<i class="fa-brands fa-github leading-none" aria-hidden="true"></i>
			</a>
			<a
				class="btn-pressdown focus-ring hidden size-10 items-center justify-center border border-transparent text-[rgb(var(--muted))] no-underline hover:border-[rgb(var(--border))] hover:text-[rgb(var(--fg))] sm:inline-flex"
				href={site.linkedin}
				target="_blank"
				rel="noreferrer"
				aria-label="LinkedIn"
				title="LinkedIn"
			>
				<i class="fa-brands fa-linkedin-in leading-none" aria-hidden="true"></i>
			</a>

			<button
				type="button"
				class="btn-pressdown focus-ring cursor-pointer grid size-10 place-items-center border border-[rgb(var(--border))] bg-[rgb(var(--bg))] text-[rgb(var(--fg))]"
				data-theme-toggle
				aria-label="Toggle theme"
				title="Toggle theme"
			>
				<span class="sr-only">Toggle theme</span>
				<span class="inline-flex items-center justify-center" aria-hidden="true">
					<svg
						data-theme-icon="sun"
						viewBox="0 0 24 24"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							d="M12 18a6 6 0 1 0 0-12 6 6 0 0 0 0 12Z"
							stroke="currentColor"
							stroke-width="2"
						/>
						<path
							d="M12 2v2M12 20v2M4 12H2M22 12h-2M5.64 5.64 4.22 4.22M19.78 19.78l-1.42-1.42M18.36 5.64l1.42-1.42M4.22 19.78l1.42-1.42"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
						/>
					</svg>
					<svg
						data-theme-icon="moon"
						viewBox="0 0 24 24"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							d="M21 13.2A8.2 8.2 0 0 1 10.8 3a6.8 6.8 0 1 0 10.2 10.2Z"
							stroke="currentColor"
							stroke-width="2"
							stroke-linejoin="round"
						/>
					</svg>
				</span>
			</button>
		</div>
	</div>
</header>


